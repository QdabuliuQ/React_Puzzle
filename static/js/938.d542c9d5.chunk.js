"use strict";(self.webpackChunkq_puzzle_q=self.webpackChunkq_puzzle_q||[]).push([[938],{7418:function(t,e,a){a.r(e),a.d(e,{default:function(){return M}});var n,o,s,i,d,r,m=a(5671),c=a(3144),u=a(136),h=a(7277),v=a(2791),l=a(1010),f=a(885),x=a(7762),p=a(4942),g=a(2982),I=a(1413),Z=a(3538),b=a.n(Z),L=a(2597),z=(a(6529),a(9205)),y=a(1895),W=a(184),j=function(t){(0,u.Z)(v,t);var e=(0,h.Z)(v);function v(){var t;(0,m.Z)(this,v);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(t=e.call.apply(e,[this].concat(o))).state={randomList:[],imageList:[],containWidth:0,isLoad:!0,itemWidth:0,imageUrl:"",mode:3,gap:5,moveIndex:0,moveLeft:0,moveTop:0},t.getImageUrl=function(){t.setState({imageUrl:a(6039)},(function(){var e=new Image;e.src=t.state.imageUrl,e.crossOrigin="",e.onload=function(){var a=e.width>e.height?e.height:e.width;t.computedCanvas(e,a)}}))},t.computedCanvas=function(e,a){for(var n=[],o=a/t.state.mode,s=1,i=0;i<t.state.mode;i++)for(var d=0;d<t.state.mode;d++){if(d!=t.state.mode-1||i!=t.state.mode-1){var r=document.createElement("canvas"),m=r.getContext("2d");r.width=o,r.height=o,r.style.width="100%",m.drawImage(e,d*o,i*o,o,o,0,0,o,o),n.push((0,I.Z)((0,I.Z)({},t.computedAxis(s-1,"x","y")),{},{index:s,base64:r.toDataURL("image/png")}))}s++}t.setState({imageList:n},(function(){t.randomList()}))},t.randomList=function(){var e=(0,g.Z)(t.state.imageList);e.sort((function(t){return Math.random()-.5}));var a=t.state.mode*t.state.mode;e.push((0,I.Z)((0,I.Z)({},t.computedAxis(a-1,"x","y")),{},{index:a,moveIndex:a}));for(var n=0;n<e.length;n++)e[n]=Object.assign(e[n],{moveIndex:n+1},t.computedAxis(n));t.setState({randomList:e,isLoad:!1})},t.computedAxis=function(e){var a,n,o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top";return 0==e?(n=e%t.state.mode*t.state.itemWidth+"px",o=Math.floor(e/t.state.mode)*t.state.itemWidth+"px"):0!=e&&e<t.state.mode?(n=e%t.state.mode*t.state.itemWidth+t.state.gap*(e%t.state.mode)+"px",o=Math.floor(e/t.state.mode)*t.state.itemWidth+"px"):e%t.state.mode==0?(n=e%t.state.mode*t.state.itemWidth+"px",o=Math.floor(e/t.state.mode)*t.state.itemWidth+t.state.gap*Math.floor(e/t.state.mode)+"px"):(n=e%t.state.mode*t.state.itemWidth+t.state.gap*(e%t.state.mode)+"px",o=Math.floor(e/t.state.mode)*t.state.itemWidth+t.state.gap*Math.floor(e/t.state.mode)+"px"),a={},(0,p.Z)(a,s,n),(0,p.Z)(a,i,o),a},t.movePuzzleItem=function(e){var a,n=(0,g.Z)(t.state.randomList),o=(0,x.Z)(t.state.randomList.entries());try{for(o.s();!(a=o.n()).done;){var s=(0,f.Z)(a.value,2),i=s[0],d=s[1];if(d.moveIndex==e){var r=d.left,m=d.top,c=d.moveIndex;n[i].left=t.state.moveLeft,n[i].top=t.state.moveTop,n[i].moveIndex=t.state.moveIndex,t.setState({randomList:n,moveLeft:r,moveTop:m,moveIndex:c},(function(){t.checkPuzzle()}));break}}}catch(u){o.e(u)}finally{o.f()}},t.touchEndEvent=function(e){e.preventDefault();var a,n,o=t.state.mode*t.state.mode;switch(a=e.changedTouches[0].pageX,n=e.changedTouches[0].pageY,t.getDirection(d,r,a,n)){case 1:t.state.moveIndex+t.state.mode<=o&&t.movePuzzleItem(t.state.moveIndex+t.state.mode);break;case 2:t.state.moveIndex-t.state.mode>=0&&t.movePuzzleItem(t.state.moveIndex-t.state.mode);break;case 3:t.state.moveIndex+1<=o&&t.state.moveIndex%t.state.mode!=0&&t.movePuzzleItem(t.state.moveIndex+1);break;case 4:t.state.moveIndex-1>=0&&t.state.moveIndex%t.state.mode!=1&&t.movePuzzleItem(t.state.moveIndex-1)}},t.touchStartEvent=function(t){d=t.touches[0].pageX,r=t.touches[0].pageY},t.checkPuzzle=function(){var e,a=(0,x.Z)(t.state.randomList);try{for(a.s();!(e=a.n()).done;){var n=e.value;if(n.x!=n.left||n.y!=n.top)return}}catch(o){a.e(o)}finally{a.f()}b().publish("success")},t.getDirection=function(e,a,n,o){var s=n-e,i=o-a,d=0;if(Math.abs(s)<2&&Math.abs(i)<2)return d;var r=t.getAngle(s,i);return r>=-135&&r<=-45?d=1:r>45&&r<135?d=2:r>=135&&r<=180||r>=-180&&r<-135?d=3:r>=-45&&r<=45&&(d=4),d},t.getAngle=function(t,e){return 180*Math.atan2(e,t)/Math.PI},t}return(0,c.Z)(v,[{key:"componentDidMount",value:function(){var t=this,e=(document.documentElement.clientWidth-30)/this.state.mode;this.setState({moveIndex:this.state.mode*this.state.mode,itemWidth:e,containWidth:e*this.state.mode+(this.state.mode-1)*this.state.gap}),this.getImageUrl(),document.addEventListener("touchstart",this.touchStartEvent,!1),document.addEventListener("touchend",this.touchEndEvent,!1),setTimeout((function(){var e=t.computedAxis(t.state.mode*t.state.mode-1,"x","y"),a=e.x,n=e.y;t.setState({moveLeft:a,moveTop:n})}),100),n=b().subscribe("replace",(function(){t.setState({isLoad:!0},(function(){t.getImageUrl()}))})),o=b().subscribe("save",(function(){(0,z.Z)(t.state.imageUrl,"image")})),s=b().subscribe("rank",(function(){t.setState({isLoad:!0},(function(){t.randomList()}))})),i=b().subscribe("modeChange",(function(e,a){t.setState({isLoad:!0,itemWidth:(t.state.containWidth-(a-1)*t.state.gap)/a,mode:a,moveIndex:a*a},(function(){var e=new Image;e.src=t.state.imageUrl,e.crossOrigin="";var n=t.computedAxis(a*a-1,"x","y"),o=n.x,s=n.y;t.setState({moveLeft:o,moveTop:s}),e.onload=function(){var a=e.width>e.height?e.height:e.width;t.computedCanvas(e,a)}}))}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("touchstart",this.touchStartEvent),document.removeEventListener("touchend",this.touchEndEvent),b().unsubscribe(n),b().unsubscribe(o),b().unsubscribe(s),b().unsubscribe(i)}},{key:"render",value:function(){var t=this.state,e=t.isLoad,a=t.randomList,n=t.containWidth,o=t.itemWidth;return(0,W.jsx)("div",{id:"Puzzle",children:(0,W.jsxs)("div",{style:{width:n+"px"},className:"puzzleContainer",children:[e&&(0,W.jsx)("div",{className:"loadMask",children:(0,W.jsx)(L.wW,{style:{"--color":"#eaad30","--size":"100px"}})}),a.map((function(t,e){return(0,W.jsx)(y.Z,{i:t.index,image:t.base64,size:o,left:t.left,top:t.top,index:e},e)}))]})})}}]),v}(v.Component),k=a(8676),w=a(6788),E=a(7405),C=a(8698),M=function(t){(0,u.Z)(n,t);var e=(0,h.Z)(n);function n(){return(0,m.Z)(this,n),e.apply(this,arguments)}return(0,c.Z)(n,[{key:"render",value:function(){return(0,W.jsxs)("div",{id:"ComplexPage",children:[(0,W.jsx)(C.Z,{}),(0,W.jsx)(l.Z,{}),(0,W.jsx)("div",{className:"logoContainer",children:(0,W.jsx)("img",{src:a(4427),alt:""})}),(0,W.jsx)(j,{}),(0,W.jsxs)("div",{className:"bottomBox",children:[(0,W.jsx)(w.Z,{}),(0,W.jsx)(E.Z,{})]}),(0,W.jsx)(k.Z,{})]})}}]),n}(v.Component)},1010:function(t,e,a){a.d(e,{Z:function(){return m}});var n=a(5671),o=a(3144),s=a(136),i=a(7277),d=a(2791),r=a(184),m=function(t){(0,s.Z)(d,t);var e=(0,i.Z)(d);function d(){return(0,n.Z)(this,d),e.apply(this,arguments)}return(0,o.Z)(d,[{key:"render",value:function(){return(0,r.jsx)("div",{id:"PageBg",children:(0,r.jsx)("img",{src:a(8496),alt:""})})}}]),d}(d.Component)}}]);
//# sourceMappingURL=938.d542c9d5.chunk.js.map